<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laundry Management System - Student Database</title>
</head>
<body style="font-family: Arial, sans-serif; background-color: #f4f4f4; color: #333;">
    <h1 style="color: #4CAF50;">Laundry Management System</h1>
    <h2 style="color: #009688;">Student Laundry Database</h2>

    <form id="laundryForm" style="background-color: #fff; padding: 20px; border-radius: 10px; width: 300px;">
        <p id="regnDisplay" style="color: #333; font-weight: bold;"></p>
        <label for="clothCount" style="color: #333;">Cloth Count:</label><br>
        <input type="number" id="clothCount" placeholder="Enter Cloth Count" required style="width: 100%; padding: 8px; margin: 10px 0; border-radius: 5px; border: 1px solid #ccc;"><br>

        <button type="button" onclick="submitData()" style="background-color: #4CAF50; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;">
            Submit
        </button>
    </form>

    <h2 style="color: #009688; margin-top: 30px;">Submission Record</h2>
    <table id="recordTable" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
        <thead>
            <tr style="background-color: #009688; color: white;">
                <th style="padding: 10px; border: 1px solid #ccc;">Serial Number</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Cloth Count</th>
                <th style="padding: 10px; border: 1px solid #ccc;">Date</th>
            </tr>
        </thead>
        <tbody>
            <!-- Records will be inserted here -->
        </tbody>
    </table>

    <script>
        const maxSubmissions = 4;
        const maxClothCount = 25;
        const regnNo = new URLSearchParams(window.location.search).get('regnNo');
        const database = JSON.parse(localStorage.getItem('laundryDatabase')) || {};

        if (!database[regnNo]) {
            database[regnNo] = [];
        }

        document.getElementById('regnDisplay').textContent = `Registration Number: ${regnNo}`;

        function submitData() {
            const clothCount = parseInt(document.getElementById('clothCount').value.trim(), 10);
            const currentDate = new Date().toLocaleDateString();

            if (isNaN(clothCount) || clothCount <= 0) {
                alert('Please enter a valid cloth count.');
                return;
            }

            if (clothCount > maxClothCount) {
                alert('Maximum cloth count exceeded. Please enter 25 or fewer clothes.');
                return;
            }

            const currentMonth = new Date().getMonth();
            const filteredSubmissions = database[regnNo].filter(sub => new Date(sub.date).getMonth() === currentMonth);

            if (filteredSubmissions.length >= maxSubmissions) {
                alert('You have reached the maximum submissions for this month.');
                return;
            }

            const newSubmission = {
                clothCount,
                date: currentDate
            };

            database[regnNo].push(newSubmission);
            localStorage.setItem('laundryDatabase', JSON.stringify(database));

            updateTable();
        }

        function updateTable() {
            const tableBody = document.querySelector('#recordTable tbody');
            tableBody.innerHTML = '';

            database[regnNo].forEach((submission, index) => {
                const row = document.createElement('tr');

                const serialCell = document.createElement('td');
                serialCell.textContent = index + 1;
                serialCell.style.padding = '10px';
                serialCell.style.border = '1px solid #ccc';
                row.appendChild(serialCell);

                const clothCell = document.createElement('td');
                clothCell.textContent = submission.clothCount;
                clothCell.style.padding = '10px';
                clothCell.style.border = '1px solid #ccc';
                row.appendChild(clothCell);

                const dateCell = document.createElement('td');
                dateCell.textContent = submission.date;
                dateCell.style.padding = '10px';
                dateCell.style.border = '1px solid #ccc';
                row.appendChild(dateCell);

                tableBody.appendChild(row);
            });
        }

        updateTable();
    </script>
</body>
</html>
